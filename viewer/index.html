<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	
<link href="style.css" rel="stylesheet" type="text/css"  >


<script src='js/jquery-1.7.2.min.js' type='text/javascript' ></script>
<script type="text/javascript" src="minicolors/jquery.miniColors.js"></script>
<link type="text/css" rel="stylesheet" href="minicolors/jquery.miniColors.css" />


<script type="text/javascript" src="js/jquery.simplemodal.1.4.2.min.js"></script>
<link type='text/css' href='style/basic.css' rel='stylesheet' media='screen' />

<script src='Three.js' type='text/javascript' ></script>

<script src='FirstPersonNavigationControls.js' type='text/javascript' ></script>

<script src='sun.js' type='text/javascript' ></script>

<script src='3dview.js' type='text/javascript' ></script>
<script src='2dview.js' type='text/javascript' ></script>

<script src='mapcolor.js' type='text/javascript' ></script>
<script src='mapcolorgui.js' type='text/javascript' ></script>

<script src='js/jquery.base64.min.js' type='text/javascript' ></script>
<script src='libs/bzip2.js' type='text/javascript' ></script>


<script src='libs/raster.js' type='text/javascript' ></script>

<script type='text/javascript' >
	
	var mapcolor;  
	var mapcolorgui; 
	var img; 
		
	function renderMode(mode){
		if(mapcolor.mode_2d){
		   $('#mode').html('Switch to 3D Mode');
		}else{
		   $('#mode').html('Switch to 2D Mode');
		}
	}; 
	
	function isCanvasSupported(){
		var elem = document.createElement('canvas');
		return !(elem.getContext && elem.getContext('2d') && elem.getContext('3d'));
	}; 
	
	function getUrlVars() {
		var vars = {};
		var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
			vars[key] = value;
		});
		return vars;
	}
	
	$(document).ready(
	  function () {
		  $('#content').hide(); 
		  if(isCanvasSupported()) {
				/*Raster.load_png ('dv.png',
					function (raster) {
						mapcolor = new MapColor(raster);
						mapcolor.setMode2D(true);
						renderMode();

						$('#mode').click(function(){ 
							 mapcolor.toggleMode();
						}); 

						$('#loading').hide(); 
						$('#content').show(); 
								 
						mapcolorgui = new MapColorGUI(mapcolor, $('#mapcolor_gui'));
						mapcolorgui.render();
					}, function (err) {
						alert(err);
					},
					100
				);*/

				function load_raster (raster) {
					mapcolor = new MapColor(raster);
						mapcolor.setMode2D(true);
						renderMode();

						$('#mode').click(function(){ 
							 mapcolor.toggleMode();
						}); 

						$('#loading').hide(); 
						$('#content').show(); 
								 
						mapcolorgui = new MapColorGUI(mapcolor, $('#mapcolor_gui'));
						mapcolorgui.render();
				};

				function error (err) {
					alert(err);
				};
				
				downloadFile(
					'utm.json.bz2',
					function (bytes) {
						Raster.load_json_bz2 (bytes, load_raster,	error);
					}
				);
				
			}else{
				$('#not_suported').modal(); 
			}
		}
	);
	
	
</script>

</head>

<body>
<div class='help' >If you are having problems seeing or intereacting with this page please consult the <a target='_blank' href='help.html'>help page</a>.</div>

<div id='loading'  class='info' >
			<p style='color:red'>Loading... Please be patiant, this may take a while.</p>
			<p>3D Mode:</p>
			<ul>
				<li>Use mouse to change angle, and arrow keys or W,A,S,D to navigate.</li>
			</ul>
</div>

<div id='not_suported'  style='display: none' >
	<p>We are sorry but this feature is not supported by your browser please 
	  try our <a target='_blank' href='../maps/help.html#terrain_viewer'>help</a> page to solve the problem. 
	</p>
</div>



<div id='content'  >


<div style="visibility:hidden; width:0px; height:0px;">
	<div>
		<div id='save_pallet_modal'>
			<fieldset >
				<legend>Save Pallet</legend>
				Please insert a name that identify this pallet: 
				<p>
				<input type='text' id='pallet_name' value='my pallet' >
				<button id='save_pallet' >Save</button> 
				</p>
			</fieldset>
			
			<p style='color: #ff0000;'>
				(X) Close to cancel. 
			</p>
		</div>
	</div>
</div>

<div id='mapcolor_gui'>
	<fieldset>
		<legend>Elevation</legend>
		<div style='float:left;'>x</div><div style='float:right;' id='location_x'></div><br>
		<div style='float:left;' >y</div><div style='float:right;' id='location_y'></div>
	</fieldset>
	<button id='mode'></button>
	<p>Flat Render<input type='checkbox' id='flat' /></p>
	<fieldset>
		<legend>Elevation</legend>
		<div style='float:left;'>max</div><div style='float:right;' id='e_max'></div><br>
		<div style='float:left;' >min</div><div style='float:right;' id='e_min'></div>
	</fieldset>
	<fieldset>
		<legend>Pallet</legend>
	<select id='pallets'></select>
	<p>Number of colors: <input id='colors' type='text' value='2' style='width: 50px;'/></p> 
	<div class='container'></div>
	<canvas id='scale_colors'></canvas>
	<div style='clear: both'></div>
	<button id='apply' >Apply</button>
	
	<button id='save'>Save</button>
	<button id='save_as'>Save As</button>
	<button id='delete'>Delete</button>
	</fieldset>
	
	<fieldset>
		<legend>Sun</legend>
		<p>X angle <input type='number' id='x_angle' value='0' /></p>
		<p>Y angle <input type='number' id='y_angle' value='0' /></p>
		
		<button id='apply_angles'>Apply Angles</button>
		<p>Opacity <input id='sun_alpha' /></p>
		<!-- <p>Show <input type='checkbox' id='show_sun'/></p> -->
	</fieldset>
</div>
<div id="viewport"></div>


</div>




</body>
</html> 




